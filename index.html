<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Scala ORP by simono</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>Scala ORP</h1>
          <h2>Object-Relational Programming in Scala</h2>
        </header>

        <section id="downloads" class="clearfix">
          <a href="https://github.com/simono/scala-orp/zipball/master" id="download-zip" class="button"><span>Download .zip</span></a>
          <a href="https://github.com/simono/scala-orp/tarball/master" id="download-tar-gz" class="button"><span>Download .tar.gz</span></a>
          <a href="https://github.com/simono/scala-orp" id="view-on-github" class="button"><span>View on GitHub</span></a>
        </section>

        <hr>

        <section id="main_content">
          <h3>Welcome to the Scala ORP Project.</h3>

<p>This Project extends the <a href="http://www.scala-lang.org">Scala Programming Language</a> with <em>Object-Relational Programming</em> (ORP). It was developed as part of a <a href="http://www.fernuni-hagen.de/ps/arbeiten/olofsson.shtml">Master's thesis</a> (available in German only) at the FernUniversit√§t in Hagen. Most of the research papers are also written in German:</p>

<ul>
<li><a href="http://www.fernuni-hagen.de/ps/veroeffentlichungen/Mod2010.shtml"><em>"Wie die Objektorientierung relationaler werden sollte: Eine Analyse aus Sicht der Datenmodellierung"</em></a></li>
<li><a href="http://www.fernuni-hagen.de/ps/veroeffentlichungen/SE2010.shtml"><em>"Objektrelationale Programmierung"</em></a></li>
</ul><p><a href="https://powerjava.googlecode.com/files/10152.SteimannFriedrich.Paper.pdf"><em>"Towards Object-Relational Programming"</em></a> is written in English and explains the basic ideas:</p>

<blockquote>
<p>While the relational data model and its commercial implementations have undergone considerable extensions to become object-relational, comparable advances from mainstream object-oriented programming languages seem to be rare. Complementing recent efforts to integrate SQL-like querying of memory-based collections into languages such as C# and Java, we specify a gentle extension of the object-oriented programming model with bidirectional relationships that are uniform across all uses. To substantiate our object-relational programming model, we sketch two concrete implementations, one in Smalltalk and one in Scala. Perhaps most remarkable is the fact that our extension of objects does not introduce relationships as a first class language construct.</p>
</blockquote>

<p>This Project implements an annotation-based extension of Scala, that uses a Compiler Plugin to transform the Source Code. The API is straightforward and explained below.</p>

<h3>API and Usage</h3>

<p>The <a href="https://github.com/simono/scala-orp/blob/master/orp-framework/src/main/scala/orp/api.scala">ORP API</a> defines four Annotations (Types omitted for brevity):</p>

<ul>
<li>
<code>@relationship</code>: Marks an <code>object</code> as Relationship with two Roles</li>
<li>
<code>@role(multiplicity = Many)</code>: A Role in a Relationship, with Multiplicity <code>One</code> or <code>Many</code> (the default)</li>
<li>
<code>@plays(roles*)</code>: A Class can play one or more Roles</li>
<li>
<code>@playsFor(role, forClass)</code>: In some cases a Class plays a Role only for <em>one</em> other Class</li>
</ul><p>A Role can be selected with <code>role[T]</code>, just like you select classes with <code>classOf[T]</code>.</p>

<h4>Example for plays</h4>

<p>The following defines a bidirectional, one-to-many relationship between a Customer and his Contracts:</p>

<div class="highlight"><pre><span class="k">import</span> <span class="nn">orp.api._</span>

<span class="nd">@relationship</span>
<span class="k">object</span> <span class="nc">CustomerContract</span> <span class="o">{</span>
  <span class="nd">@role</span><span class="o">(</span><span class="nc">One</span><span class="o">)</span> <span class="k">trait</span> <span class="nc">Customer</span>
  <span class="nd">@role</span> <span class="k">trait</span> <span class="nc">Contract</span>
<span class="o">}</span>
</pre></div>

<p>Now the Class <code>MyCustomer</code> plays the Role <code>Customer</code> and the Class <code>MyContract</code> plays <code>Contract</code>:</p>

<div class="highlight"><pre><span class="k">import</span> <span class="nn">orp.api._</span>

<span class="nd">@plays</span><span class="o">(</span><span class="n">role</span><span class="o">[</span><span class="kt">CustomerContract.Customer</span><span class="o">])</span>
<span class="k">class</span> <span class="nc">MyCustomer</span>

<span class="nd">@plays</span><span class="o">(</span><span class="n">role</span><span class="o">[</span><span class="kt">CustomerContract.Contract</span><span class="o">])</span>
<span class="k">class</span> <span class="nc">MyContract</span>
</pre></div>

<p>You can use the classes like this:</p>

<div class="highlight"><pre>  <span class="k">val</span> <span class="n">customer</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MyCustomer</span>
  <span class="k">val</span> <span class="n">contract</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MyContract</span>

  <span class="n">customer</span><span class="o">.</span><span class="n">addContract</span><span class="o">(</span><span class="n">contract</span><span class="o">)</span>
  <span class="n">assert</span><span class="o">(</span><span class="mi">1</span> <span class="o">==</span> <span class="n">customer</span><span class="o">.</span><span class="n">getContracts</span><span class="o">.</span><span class="n">size</span><span class="o">)</span>
  <span class="n">customer</span><span class="o">.</span><span class="n">removeContract</span><span class="o">(</span><span class="n">contract</span><span class="o">)</span>
  <span class="n">assert</span><span class="o">(</span><span class="n">customer</span><span class="o">.</span><span class="n">getContracts</span><span class="o">.</span><span class="n">isEmpty</span><span class="o">)</span>
</pre></div>

<h4>Example for playsFor</h4>

<p>To define a part-whole relationship with additional methods:</p>

<div class="highlight"><pre><span class="k">import</span> <span class="nn">orp.api._</span>

<span class="nd">@relationship</span>
<span class="k">object</span> <span class="nc">PartWhole</span> <span class="o">{</span>

  <span class="nd">@role</span> <span class="k">trait</span> <span class="nc">Part</span> <span class="o">{</span>
    <span class="k">def</span> <span class="n">belongsTo</span><span class="o">(</span><span class="n">whole</span> <span class="k">:</span> <span class="kt">Whole</span><span class="o">)</span> <span class="k">=</span> <span class="n">partOf</span><span class="o">(</span><span class="n">whole</span><span class="o">,</span> <span class="k">this</span><span class="o">)</span>
  <span class="o">}</span>

  <span class="nd">@role</span><span class="o">(</span><span class="nc">One</span><span class="o">)</span> <span class="k">trait</span> <span class="nc">Whole</span> <span class="o">{</span>
    <span class="k">def</span> <span class="n">contains</span><span class="o">(</span><span class="n">part</span> <span class="k">:</span> <span class="kt">Part</span><span class="o">)</span> <span class="k">=</span> <span class="n">partOf</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">part</span><span class="o">)</span>
  <span class="o">}</span>

  <span class="k">def</span> <span class="n">partOf</span><span class="o">(</span><span class="n">whole</span> <span class="k">:</span> <span class="kt">Whole</span><span class="o">,</span> <span class="n">part</span> <span class="k">:</span> <span class="kt">Part</span><span class="o">)</span> <span class="k">=</span> <span class="n">whole</span><span class="o">.</span><span class="n">getParts</span><span class="o">.</span><span class="n">contains</span><span class="o">(</span><span class="n">part</span><span class="o">)</span>
<span class="o">}</span>
</pre></div>

<p>This relationship is very wide, a Class that plays <code>Part</code> is typically playing this for another Class. A <code>Car</code> could play the <code>Whole</code> Role, but not for every <code>Part</code>, just for Parts of Class <code>Engine</code>. This is where the playsFor-annotation is needed. <code>Engine</code> plays <code>Part</code> for <code>Car</code> and <code>Car</code> plays <code>Whole</code> for <code>Engine</code>:</p>

<div class="highlight"><pre><span class="k">import</span> <span class="nn">orp.api._</span>

<span class="nd">@playsFor</span><span class="o">(</span><span class="n">role</span><span class="o">[</span><span class="kt">PartWhole.Part</span><span class="o">],</span> <span class="n">classOf</span><span class="o">[</span><span class="kt">Car</span><span class="o">])</span>
<span class="k">class</span> <span class="nc">Engine</span>
<span class="nd">@playsFor</span><span class="o">(</span><span class="n">role</span><span class="o">[</span><span class="kt">PartWhole.Whole</span><span class="o">],</span> <span class="n">classOf</span><span class="o">[</span><span class="kt">Engine</span><span class="o">])</span>
<span class="k">class</span> <span class="nc">Car</span>

<span class="nd">@plays</span><span class="o">(</span><span class="n">role</span><span class="o">[</span><span class="kt">PartWhole.Part</span><span class="o">])</span>
<span class="k">class</span> <span class="nc">OtherPart</span>
</pre></div>

<p>Now you can only add Engines to a Car:</p>

<div class="highlight"><pre><span class="k">new</span> <span class="nc">Car</span><span class="o">().</span><span class="n">addPart</span><span class="o">(</span><span class="k">new</span> <span class="nc">Engine</span><span class="o">)</span> <span class="c1">// Works</span>
<span class="k">new</span> <span class="nc">Car</span><span class="o">().</span><span class="n">addPart</span><span class="o">(</span><span class="k">new</span> <span class="nc">OtherPart</span><span class="o">)</span> <span class="c1">// Doesn't Work</span>
</pre></div>

<h3>Authors and License</h3>

<p>This project is maintained by <a href="https://github.com/simono" class="user-mention">@simono</a> and licensed under the Apache 2 license. For Setup instructions and License details, see the <a href="https://github.com/simono/scala-orp">Project page</a>. If you have any questions or comments, please contact <a href="https://github.com/simono" class="user-mention">@simono</a>.</p>
        </section>

        <footer>
          Scala ORP is maintained by <a href="https://github.com/simono">simono</a><br>
          This page was generated by <a href="http://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="http://twitter.com/jasonlong">Jason Long</a>.
        </footer>

        
      </div>
    </div>
  </body>
</html>